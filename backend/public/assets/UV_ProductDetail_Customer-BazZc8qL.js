import{a as ve,u as $,b as F,j as e}from"./state-vendor-__gb9IU9.js";import{f as Ne,r as x,L as A}from"./react-vendor-QYi6USC3.js";import{u as Q,l as we,a as u}from"./index-DxqMT8zM.js";import{h as z,X as te,W as _e,K as E,Z as ke,V as Ce,f as ae,c as Se,_ as $e,g as j,N as Fe,J as Pe}from"./ui-vendor-CuJPReAW.js";const h="https://123create-construction-app-with-a.launchpulse.ai/api",qe=async(r,n)=>{const l={"Content-Type":"application/json"};return n&&(l.Authorization=`Bearer ${n}`),(await u.get(`${h}/products/${r}`,{headers:l})).data},Ae=async(r,n)=>{const l={"Content-Type":"application/json"};return n&&(l.Authorization=`Bearer ${n}`),(await u.get(`${h}/suppliers/${r}`,{headers:l})).data},Ie=async(r,n,l,p,f)=>{const o={product_id:r,status:"published",limit:10,offset:(n-1)*10,sort_by:f,sort_order:"desc"};return l&&(o.min_rating=l),p&&(o.verified_purchase=!0),(await u.get(`${h}/reviews`,{params:o})).data},Re=async(r,n)=>(await u.get(`${h}/wishlist`,{headers:{Authorization:`Bearer ${n}`}})).data.some(f=>f.product_id===r),Te=async(r,n,l)=>(await u.post(`${h}/cart/items`,{product_id:r,quantity:n},{headers:{Authorization:`Bearer ${l}`}})).data,Me=async(r,n,l)=>(await u.post(`${h}/wishlist`,{product_id:r,price_when_saved:n,price_drop_alert_enabled:!0,back_in_stock_alert_enabled:!0},{headers:{Authorization:`Bearer ${l}`}})).data,Le=async(r,n)=>(await u.delete(`${h}/wishlist/${r}`,{headers:{Authorization:`Bearer ${n}`}})).data,Be=async(r,n)=>(await u.get(`${h}/reviews/can-review/${r}`,{headers:{Authorization:`Bearer ${n}`}})).data,We=async(r,n,l)=>(await u.post(`${h}/chat/conversations`,{conversation_type:"customer_supplier",supplier_id:r,related_entity_type:"product",related_entity_id:n},{headers:{Authorization:`Bearer ${l}`}})).data,Oe=()=>{var G,ee;const{product_id:r}=Ne(),n=ve(),l=Q(s=>s.authentication_state.auth_token),p=Q(s=>s.fetch_cart),f=Q(s=>s.cart_state.items),[o,P]=x.useState("description"),[I,q]=x.useState(0),[re,K]=x.useState(!1),[b,O]=x.useState(1),[_,k]=x.useState(1),[v,D]=x.useState({rating:null,verified_only:!1}),[R,ie]=x.useState("review_date"),[le,C]=x.useState(!1),[g,y]=x.useState({rating_overall:5,rating_product:5,rating_service:5,rating_delivery:5,review_text:"",would_buy_again:"yes",is_anonymous:!1}),[N,T]=x.useState({stock_quantity:null,last_updated:null,websocket_connected:!1}),{data:t,isLoading:ne,error:oe}=$({queryKey:["product",r],queryFn:()=>qe(r,l),enabled:!!r,staleTime:2*60*1e3}),{data:c}=$({queryKey:["supplier",t==null?void 0:t.supplier_id],queryFn:()=>Ae(t.supplier_id,l),enabled:!!(t!=null&&t.supplier_id),staleTime:5*60*1e3}),{data:M=!1,refetch:U}=$({queryKey:["wishlist-status",r],queryFn:()=>Re(r,l),enabled:!!r&&!!l,staleTime:1*60*1e3}),{data:m,isLoading:ce}=$({queryKey:["reviews",r,_,v.rating,v.verified_only,R],queryFn:()=>Ie(r,_,v.rating,v.verified_only,R),enabled:!!r&&o==="reviews",staleTime:2*60*1e3}),{data:d}=$({queryKey:["can-review",r],queryFn:()=>Be(r,l),enabled:!!r&&!!l&&o==="reviews",staleTime:1*60*1e3}),V=f.some(s=>s.product_id===r),de=((G=f.find(s=>s.product_id===r))==null?void 0:G.quantity)||0,H=F({mutationFn:s=>Te(r,s,l),onSuccess:()=>{p(),n.invalidateQueries({queryKey:["cart"]}),n.invalidateQueries({queryKey:["cart-summary"]}),alert("Added to cart successfully!")},onError:s=>{var a,i;alert(((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to add to cart")}}),L=F({mutationFn:()=>We(t.supplier_id,r,l),onSuccess:()=>{window.dispatchEvent(new CustomEvent("openChatWithSupplier",{detail:{supplier_id:t.supplier_id,product_id:r}})),alert("Chat started! Check the chat widget.")},onError:s=>{var a,i;alert(((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to start conversation")}}),J=F({mutationFn:()=>Me(r,t.price_per_unit,l),onSuccess:()=>{U(),alert("Added to wishlist!")},onError:s=>{var a,i;alert(((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to add to wishlist")}}),Y=F({mutationFn:async()=>{const a=(await u.get(`${h}/wishlist`,{headers:{Authorization:`Bearer ${l}`}})).data.find(i=>i.product_id===r);if(a)return Le(a.wishlist_item_id,l)},onSuccess:()=>{U(),alert("Removed from wishlist")}}),B=F({mutationFn:async()=>(await u.post(`${h}/reviews`,{order_id:d==null?void 0:d.order_id,supplier_id:d==null?void 0:d.supplier_id,product_id:r,...g},{headers:{Authorization:`Bearer ${l}`}})).data,onSuccess:()=>{n.invalidateQueries({queryKey:["reviews",r]}),n.invalidateQueries({queryKey:["can-review",r]}),C(!1),y({rating_overall:5,rating_product:5,rating_service:5,rating_delivery:5,review_text:"",would_buy_again:"yes",is_anonymous:!1}),alert("Review submitted successfully!")},onError:s=>{var a,i;alert(((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to submit review")}});x.useEffect(()=>{if(!r||!l)return;const a=we("ws://localhost:3000",{auth:{token:l}});return a.on("connect",()=>{T(i=>({...i,websocket_connected:!0})),a.emit("subscribe_product",{product_id:r})}),a.on("inventory_update",i=>{i.product_id===r&&T({stock_quantity:i.stock_quantity,last_updated:i.last_updated_timestamp,websocket_connected:!0})}),a.on("disconnect",()=>{T(i=>({...i,websocket_connected:!1}))}),()=>{a.emit("unsubscribe_product",{product_id:r}),a.disconnect()}},[r,l]);const me=()=>{if(!t)return;if(b<t.minimum_order_quantity){alert(`Minimum order quantity is ${t.minimum_order_quantity}`);return}const s=N.stock_quantity??t.stock_quantity;if(b>s){alert(`Only ${s} units available`);return}H.mutate(b)},xe=()=>{M?Y.mutate():J.mutate()},Z=s=>{const a=b+s;if(a>=1){const i=(t==null?void 0:t.maximum_order_quantity)||(N.stock_quantity??(t==null?void 0:t.stock_quantity))||999;O(Math.min(a,i))}},ue=s=>{q(s)},he=()=>{K(!0)},pe=()=>{K(!1)},be=()=>{t!=null&&t.images&&q(s=>s===0?t.images.length-1:s-1)},ge=()=>{t!=null&&t.images&&q(s=>s===t.images.length-1?0:s+1)},w=Number(N.stock_quantity??(t==null?void 0:t.stock_quantity)??0),S=w===0?"out_of_stock":w<=Number((t==null?void 0:t.low_stock_threshold)||10)?"low_stock":"in_stock",W=()=>t!=null&&t.bulk_pricing?Object.entries(t.bulk_pricing).sort((a,i)=>parseInt(a[0])-parseInt(i[0])):null,ye=()=>{if(!t)return 0;const s=W();if(!s){const i=Number(t.price_per_unit);return isNaN(i)?0:i}for(let i=s.length-1;i>=0;i--){const[je,fe]=s[i];if(b>=parseInt(je)){const se=Number(fe);return isNaN(se)?0:se}}const a=Number(t.price_per_unit);return isNaN(a)?0:a};if(ne)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading product details..."})]})})});if(oe||!t)return e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-xl shadow-lg text-center",children:[e.jsx(z,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Product Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The product you're looking for doesn't exist or has been removed."}),e.jsx(A,{to:"/products",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Browse Products"})]})})});const X=((ee=t.images)==null?void 0:ee[I])||t.primary_image_url;return e.jsxs(e.Fragment,{children:[re&&e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",children:[e.jsx("button",{onClick:pe,className:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors","aria-label":"Close",children:e.jsx(te,{className:"h-8 w-8"})}),e.jsx("button",{onClick:be,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 transition-colors","aria-label":"Previous image",children:e.jsx(_e,{className:"h-12 w-12"})}),e.jsx("img",{src:X||"",alt:t.product_name,className:"max-w-full max-h-[90vh] object-contain"}),e.jsx("button",{onClick:ge,className:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 transition-colors","aria-label":"Next image",children:e.jsx(E,{className:"h-12 w-12"})}),t.images&&t.images.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 bg-black bg-opacity-50 p-2 rounded-lg",children:t.images.map((s,a)=>e.jsx("button",{onClick:()=>q(a),className:`h-16 w-16 rounded overflow-hidden border-2 transition-all ${a===I?"border-white scale-110":"border-transparent opacity-60 hover:opacity-100"}`,children:e.jsx("img",{src:s,alt:`Thumbnail ${a+1}`,className:"h-full w-full object-cover"})},a))})]}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-6",children:[e.jsx(A,{to:"/",className:"hover:text-blue-600 transition-colors",children:"Home"}),e.jsx(E,{className:"h-4 w-4"}),e.jsx(A,{to:"/products",className:"hover:text-blue-600 transition-colors",children:"Products"}),e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900 font-medium",children:t.product_name})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden cursor-zoom-in group relative",onClick:he,children:e.jsxs("div",{className:"aspect-square relative",children:[e.jsx("img",{src:X||"",alt:t.product_name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition-opacity flex items-center justify-center",children:e.jsx(ke,{className:"h-16 w-16 text-white"})})]})}),t.images&&t.images.length>1&&e.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:t.images.map((s,a)=>e.jsx("button",{onClick:()=>ue(a),className:`flex-shrink-0 h-20 w-20 rounded-lg overflow-hidden border-2 transition-all ${a===I?"border-blue-600 scale-105 shadow-lg":"border-gray-200 hover:border-blue-400"}`,children:e.jsx("img",{src:s,alt:`View ${a+1}`,className:"h-full w-full object-cover"})},a))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 leading-tight",children:t.product_name}),e.jsx("button",{onClick:xe,disabled:J.isPending||Y.isPending,className:"flex-shrink-0 ml-4 p-2 rounded-full hover:bg-gray-100 transition-colors disabled:opacity-50","aria-label":M?"Remove from wishlist":"Add to wishlist",children:e.jsx(Ce,{className:`h-6 w-6 transition-colors ${M?"fill-red-500 text-red-500":"text-gray-400"}`})})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["SKU: ",t.sku]}),t.brand&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Brand: ",t.brand]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-baseline space-x-3 mb-2",children:[e.jsxs("span",{className:"text-4xl font-bold text-blue-600",children:["$",ye().toFixed(2)]}),e.jsxs("span",{className:"text-lg text-gray-600",children:["/ ",t.unit_of_measure]})]}),W()&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Volume Pricing:"}),e.jsx("div",{className:"space-y-1",children:W().map(([s,a])=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[s,"+ units:"]}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",Number(a).toFixed(2)]})]},s))})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[S==="in_stock"&&e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"In Stock"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[w," units available"]})]})]}),S==="low_stock"&&e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-5 w-5 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"Low Stock"}),e.jsxs("p",{className:"text-sm text-amber-700",children:["Only ",w," left!"]})]})]}),S==="out_of_stock"&&e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-5 w-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900",children:"Out of Stock"}),t.expected_restock_date&&e.jsxs("p",{className:"text-sm text-red-700",children:["Expected: ",new Date(t.expected_restock_date).toLocaleDateString()]})]})]})]}),N.last_updated&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${N.websocket_connected?"bg-green-500":"bg-gray-400"}`}),e.jsxs("span",{children:["Updated ",new Date(N.last_updated).toLocaleTimeString()]})]})]}),S!=="out_of_stock"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[e.jsx("button",{onClick:()=>Z(-1),disabled:b<=1,className:"px-4 py-3 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"−"}),e.jsx("input",{type:"number",value:b,onChange:s=>{const a=parseInt(s.target.value);!isNaN(a)&&a>=1&&O(Math.min(a,w))},className:"w-20 text-center py-3 border-x border-gray-300 focus:outline-none"}),e.jsx("button",{onClick:()=>Z(1),disabled:b>=w,className:"px-4 py-3 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"+"})]}),t.minimum_order_quantity>1&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Min order: ",t.minimum_order_quantity]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:me,disabled:S==="out_of_stock"||H.isPending,className:"w-full bg-blue-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2",children:[e.jsx(Se,{className:"h-5 w-5"}),e.jsx("span",{children:V?"Update Cart":"Add to Cart"})]}),V&&e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[de," already in cart"]})]}),c&&e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[c.logo_url&&e.jsx("img",{src:c.logo_url,alt:c.business_name,className:"h-16 w-16 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:c.business_name}),c.verification_status==="verified"&&e.jsx($e,{className:"h-5 w-5 text-green-600"})]}),e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[[...Array(5)].map((s,a)=>e.jsx(j,{className:`h-4 w-4 ${a<Math.floor(c.rating_average)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a)),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:[Number(c.rating_average).toFixed(1)," (",c.total_reviews," reviews)"]})]}),c.response_time_average&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-3",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Replies within ",Number(c.response_time_average).toFixed(1)," hours"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(A,{to:`/supplier/${c.supplier_id}`,className:"text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"View Shop"}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsx("button",{onClick:()=>L.mutate(),disabled:L.isPending,className:"text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors disabled:opacity-50",children:L.isPending?"Starting Chat...":"Contact Supplier"})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Delivery Information"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Standard delivery: 2-5 business days"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select delivery window at checkout"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mb-12",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>P("description"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o==="description"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Description"}),e.jsx("button",{onClick:()=>P("specifications"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o==="specifications"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Specifications"}),e.jsxs("button",{onClick:()=>P("reviews"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o==="reviews"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Reviews ",m&&`(${m.total})`]})]})}),e.jsxs("div",{className:"p-6",children:[o==="description"&&e.jsxs("div",{className:"prose max-w-none",children:[t.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Product Description"}),e.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:t.description})]}),t.key_features&&t.key_features.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Key Features"}),e.jsx("ul",{className:"space-y-2",children:t.key_features.map((s,a)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(ae,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-700",children:s})]},a))})]}),t.warranty_information&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Warranty"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.warranty_information})]})]}),o==="specifications"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Technical Specifications"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[t.specifications&&Object.entries(t.specifications).map(([s,a])=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-gray-900 capitalize",children:s.replace(/_/g," ")}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:typeof a=="object"?JSON.stringify(a):String(a)})]},s)),t.dimensions&&e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:"Dimensions"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:JSON.stringify(t.dimensions)})]}),t.weight&&e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:"Weight"}),e.jsxs("td",{className:"py-3 px-4 text-sm text-gray-700",children:[t.weight," lbs"]})]}),t.material&&e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:"Material"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:t.material})]}),t.compliance_certifications&&t.compliance_certifications.length>0&&e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:"Certifications"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:t.compliance_certifications.join(", ")})]})]})})})]}),o==="reviews"&&e.jsx("div",{children:ce?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-4 border-blue-600"})}):m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("span",{className:"text-5xl font-bold text-gray-900",children:Number(m.average_rating).toFixed(1)}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-1 mb-1",children:[...Array(5)].map((s,a)=>e.jsx(j,{className:`h-6 w-6 ${a<Math.floor(Number(m.average_rating))?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a))}),e.jsxs("p",{className:"text-sm text-gray-600",children:[m.total," reviews"]})]})]})}),(d==null?void 0:d.can_review)&&e.jsx("button",{onClick:()=>C(!0),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Write a Review"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4",children:[e.jsxs("select",{value:v.rating||"",onChange:s=>{D(a=>({...a,rating:s.target.value?parseInt(s.target.value):null})),k(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All ratings"}),e.jsx("option",{value:"5",children:"5 stars"}),e.jsx("option",{value:"4",children:"4+ stars"}),e.jsx("option",{value:"3",children:"3+ stars"})]}),e.jsxs("label",{className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:v.verified_only,onChange:s=>{D(a=>({...a,verified_only:s.target.checked})),k(1)},className:"rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Verified purchases only"})]}),e.jsxs("select",{value:R,onChange:s=>{ie(s.target.value),k(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"review_date",children:"Most Recent"}),e.jsx("option",{value:"rating_overall",children:"Highest Rated"}),e.jsx("option",{value:"helpful_votes",children:"Most Helpful"})]})]})]}),e.jsx("div",{className:"space-y-6",children:m.reviews.map(s=>e.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-0",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((a,i)=>e.jsx(j,{className:`h-4 w-4 ${i<s.rating_overall?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},i))}),s.verified_purchase&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:"Verified Purchase"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.is_anonymous?"Anonymous":"Customer"," • ",new Date(s.review_date).toLocaleDateString()]})]})}),s.review_text&&e.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:s.review_text}),s.photos&&s.photos.length>0&&e.jsx("div",{className:"flex space-x-2 mb-3",children:s.photos.map((a,i)=>e.jsx("img",{src:a,alt:`Review photo ${i+1}`,className:"h-20 w-20 rounded-lg object-cover cursor-pointer hover:opacity-80 transition-opacity"},i))}),s.supplier_response&&e.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4 border-l-4 border-blue-600",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Supplier Response"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.supplier_response}),s.supplier_response_date&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Responded ",new Date(s.supplier_response_date).toLocaleDateString()]})]}),e.jsx("div",{className:"flex items-center space-x-4 mt-3 text-sm text-gray-600",children:e.jsxs("span",{children:[s.helpful_votes," found this helpful"]})})]},s.review_id))}),m.total>10&&e.jsxs("div",{className:"flex justify-center mt-8 space-x-2",children:[e.jsx("button",{onClick:()=>k(s=>Math.max(1,s-1)),disabled:_===1,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-gray-700",children:["Page ",_," of ",Math.ceil(m.total/10)]}),e.jsx("button",{onClick:()=>k(s=>Math.min(Math.ceil(m.total/10),s+1)),disabled:_>=Math.ceil(m.total/10),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-600",children:"No reviews yet for this product."}),(d==null?void 0:d.can_review)&&e.jsx("button",{onClick:()=>C(!0),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Be the first to write a review"})]})})]})]}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Similar Products"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:e.jsx("div",{className:"text-center text-gray-500 col-span-full py-8",children:"Related products would be displayed here"})})]})]})}),le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Write a Review"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(te,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overall Rating *"}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>y(a=>({...a,rating_overall:s})),className:"focus:outline-none",children:e.jsx(j,{className:`h-8 w-8 ${s<=g.rating_overall?"fill-yellow-400 text-yellow-400":"text-gray-300"} cursor-pointer hover:scale-110 transition-transform`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Quality"}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>y(a=>({...a,rating_product:s})),className:"focus:outline-none",children:e.jsx(j,{className:`h-6 w-6 ${s<=g.rating_product?"fill-yellow-400 text-yellow-400":"text-gray-300"} cursor-pointer hover:scale-110 transition-transform`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer Service"}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>y(a=>({...a,rating_service:s})),className:"focus:outline-none",children:e.jsx(j,{className:`h-6 w-6 ${s<=g.rating_service?"fill-yellow-400 text-yellow-400":"text-gray-300"} cursor-pointer hover:scale-110 transition-transform`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Experience"}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>y(a=>({...a,rating_delivery:s})),className:"focus:outline-none",children:e.jsx(j,{className:`h-6 w-6 ${s<=g.rating_delivery?"fill-yellow-400 text-yellow-400":"text-gray-300"} cursor-pointer hover:scale-110 transition-transform`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review"}),e.jsx("textarea",{value:g.review_text,onChange:s=>y(a=>({...a,review_text:s.target.value})),rows:5,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Share your experience with this product..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Would you buy this again?"}),e.jsxs("select",{value:g.would_buy_again,onChange:s=>y(a=>({...a,would_buy_again:s.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"maybe",children:"Maybe"}),e.jsx("option",{value:"no",children:"No"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"anonymous",checked:g.is_anonymous,onChange:s=>y(a=>({...a,is_anonymous:s.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"anonymous",className:"ml-2 text-sm text-gray-700",children:"Post as anonymous"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>C(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:()=>B.mutate(),disabled:B.isPending,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:B.isPending?"Submitting...":"Submit Review"})]})]})]})})})]})};export{Oe as default};
