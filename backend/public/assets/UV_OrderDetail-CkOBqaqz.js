import{a as ve,u as je,b as k,j as e}from"./state-vendor-__gb9IU9.js";import{f as fe,u as Ne,r as h,L as S}from"./react-vendor-QYi6USC3.js";import{u as U,a as g}from"./index-XlgXzfNq.js";import{k as ee,K as we,a7 as _e,am as Ce,an as ke,f as se,N as Se,q as De,E as Re,o as $e,P as te,$ as Pe,J as Ae,al as Oe,z as Te,g as D}from"./ui-vendor-CuJPReAW.js";const Fe=async(t,o)=>(await g.get(`https://123create-construction-app-with-a.launchpulse.ai/api/orders/${t}`,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).data,Me=async(t,o,c)=>(await g.post(`https://123create-construction-app-with-a.launchpulse.ai/api/orders/${t}/cancel`,{cancellation_reason:o},{headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"}})).data,Le=async(t,o,c,m)=>(await g.post(`https://123create-construction-app-with-a.launchpulse.ai/api/deliveries/${t}/reschedule`,{delivery_window_start:o,delivery_window_end:c},{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}})).data,Ue=async(t,o)=>(await g.post(`https://123create-construction-app-with-a.launchpulse.ai/api/orders/${t}/reorder`,{},{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).data,Ee=async(t,o)=>(await g.get(`https://123create-construction-app-with-a.launchpulse.ai/api/orders/${t}/invoice`,{headers:{Authorization:`Bearer ${o}`},responseType:"blob"})).data,ze=async(t,o,c)=>(await g.post("https://123create-construction-app-with-a.launchpulse.ai/api/reviews",{order_id:t,...o,photos:[]},{headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"}})).data,Ke=()=>{var Y,V,J,X,H,Z;const{order_id:t}=fe(),o=Ne(),c=ve(),m=U(s=>s.authentication_state.auth_token),E=U(s=>s.fetch_cart),x=U(s=>s.websocket_connection),[re,R]=h.useState(!1),[ae,$]=h.useState(!1),[N,P]=h.useState(""),[w,A]=h.useState(""),[_,O]=h.useState(""),[T,le]=h.useState(null),[z,ie]=h.useState(null),[ne,F]=h.useState(!1),[i,u]=h.useState({supplier_id:"",product_id:"",rating_overall:5,rating_product:5,rating_service:5,rating_delivery:5,review_text:"",would_buy_again:"yes",is_anonymous:!1}),{data:b,isLoading:I,error:q}=je({queryKey:["order",t],queryFn:()=>Fe(t||"",m||""),enabled:!!t&&!!m,staleTime:3e4,retry:1}),p=k({mutationFn:s=>Me(t||"",s,m||""),onSuccess:()=>{c.invalidateQueries({queryKey:["order",t]}),R(!1),P("")}}),y=k({mutationFn:({delivery_id:s,start:l,end:d})=>Le(s,l,d,m||""),onSuccess:()=>{c.invalidateQueries({queryKey:["order",t]}),$(!1),A(""),O("")}}),M=k({mutationFn:()=>Ue(t||"",m||""),onSuccess:()=>{E(),o("/cart")}}),v=k({mutationFn:s=>ze(t||"",s,m||""),onSuccess:()=>{c.invalidateQueries({queryKey:["order",t]}),F(!1),u({supplier_id:"",product_id:"",rating_overall:5,rating_product:5,rating_service:5,rating_delivery:5,review_text:"",would_buy_again:"yes",is_anonymous:!1})}});if(h.useEffect(()=>{if(!x||!t||!b)return;x.emit("subscribe_order",{order_id:t});const s=b.delivery;s&&s.delivery_status==="out_for_delivery"&&x.emit("subscribe_delivery",{delivery_id:s.delivery_id});const l=n=>{n.order_id===t&&c.invalidateQueries({queryKey:["order",t]})},d=n=>{if(n.current_latitude&&n.current_longitude&&(le({latitude:n.current_latitude,longitude:n.current_longitude}),n.estimated_arrival_time)){const f=new Date(n.estimated_arrival_time).getTime()-Date.now();ie(Math.max(0,Math.floor(f/6e4)))}};return x.on("order_status_changed",l),x.on("delivery_location_updated",d),()=>{x.off("order_status_changed",l),x.off("delivery_location_updated",d),x.emit("unsubscribe_order",{order_id:t}),s&&x.emit("unsubscribe_delivery",{delivery_id:s.delivery_id})}},[x,t,b,c]),!t)return o("/orders"),null;if(!m)return o("/login"),null;if(!b)return null;const a=b.order,B=b.items||[],r=b.delivery,Q=b.timeline||[],de=B.reduce((s,l)=>(s[l.supplier_id]||(s[l.supplier_id]=[]),s[l.supplier_id].push(l),s),{}),oe=["pending","processing"].includes(a.status),ce=r&&["scheduled","preparing"].includes(r.delivery_status),me=r&&r.delivery_status==="out_for_delivery",xe=!["cancelled","refunded"].includes(a.status),ue=a.status==="delivered",K=a.status==="delivered",G={pending:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-300"},processing:{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-300"},shipped:{bg:"bg-indigo-100",text:"text-indigo-800",border:"border-indigo-300"},in_transit:{bg:"bg-purple-100",text:"text-purple-800",border:"border-purple-300"},delivered:{bg:"bg-green-100",text:"text-green-800",border:"border-green-300"},cancelled:{bg:"bg-red-100",text:"text-red-800",border:"border-red-300"},refunded:{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-300"}},L=G[a.status]||G.pending,j=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),C=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),he=async()=>{try{const s=await Ee(t,m),l=window.URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=`Invoice-${a.order_number}.pdf`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(l),document.body.removeChild(d)}catch(s){console.error("Invoice download failed:",s)}},be=()=>{N.trim()&&p.mutate(N)},ge=()=>{!r||!w||!_||y.mutate({delivery_id:r.delivery_id,start:w,end:_})},pe=()=>{M.mutate()},W=(s,l)=>{u({...i,supplier_id:s,product_id:l||""}),F(!0)},ye=()=>{!i.supplier_id||!i.review_text.trim()||v.mutate(i)};return e.jsxs(e.Fragment,{children:[I&&e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading order details..."})]})}),q&&e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white border-2 border-red-200 rounded-xl p-8 shadow-lg text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ee,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We couldn't find this order. It may have been removed or you may not have access to it."}),e.jsx(S,{to:"/orders",className:"inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"View All Orders"})]})})}),!I&&!q&&b&&e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(S,{to:"/orders",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(we,{className:"w-4 h-4 rotate-180 mr-1"}),"Back to Orders"]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Order #",a.order_number]}),e.jsx("span",{className:`px-4 py-2 rounded-lg text-sm font-semibold border ${L.bg} ${L.text} ${L.border}`,children:a.status.replace("_"," ").toUpperCase()})]}),e.jsxs("p",{className:"text-gray-600",children:["Placed on ",C(a.order_date)]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[oe&&e.jsxs("button",{onClick:()=>R(!0),className:"inline-flex items-center px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Cancel Order"]}),ue&&e.jsxs("button",{onClick:pe,disabled:M.isPending,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),M.isPending?"Adding to cart...":"Reorder"]}),e.jsxs("button",{onClick:he,className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-900 font-medium rounded-lg hover:bg-gray-200 transition-colors border border-gray-300",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Download Invoice"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Timeline"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-4 h-full w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-6",children:Q.map((s,l)=>{const d=s.status==="completed",n=l===Q.length-1&&!["delivered","cancelled","refunded"].includes(a.status);return e.jsxs("div",{className:"relative flex items-start gap-4",children:[e.jsx("div",{className:`relative z-10 flex items-center justify-center w-8 h-8 rounded-full border-4 ${d?"bg-green-500 border-green-200":n?"bg-blue-500 border-blue-200 animate-pulse":"bg-gray-300 border-gray-100"}`,children:d&&e.jsx(se,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 pb-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base font-semibold ${d?"text-gray-900":"text-gray-600"}`,children:s.milestone.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase())}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]}),e.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap ml-4",children:new Date(s.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C(s.timestamp)})]})]},l)})})]})]}),me&&r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Live Delivery Tracking"}),z!==null&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-800 rounded-lg",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-semibold",children:["ETA: ",z," min"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg h-96 flex items-center justify-center border-2 border-gray-300 mb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(De,{className:"w-16 h-16 text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 font-medium",children:"Live GPS Tracking"}),T&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Location: ",T.latitude.toFixed(6),", ",T.longitude.toFixed(6)]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Driver: ",r.driver_name||"En route"]})]})}),r.driver_name&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Re,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:r.driver_name}),e.jsx("p",{className:"text-sm text-gray-600",children:r.carrier||"Delivery Driver"})]})]}),r.driver_phone&&e.jsxs("a",{href:`tel:${r.driver_phone}`,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Call Driver"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Items"}),Object.entries(de).map(([s,l])=>{var d;return e.jsxs("div",{className:"mb-6 last:mb-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-200",children:[e.jsx(te,{className:"w-5 h-5 text-gray-600"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["Supplier: ",(d=l[0])==null?void 0:d.supplier_id]})]}),e.jsx("div",{className:"space-y-3",children:l.map(n=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(te,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(S,{to:`/product/${n.product_id}`,className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors truncate block",children:n.product_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["SKU: ",n.sku]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",n.quantity]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[j(n.price_per_unit)," each"]}),e.jsx("p",{className:"font-bold text-gray-900",children:j(n.line_total)}),K&&e.jsx("button",{type:"button",onClick:f=>{f.preventDefault(),f.stopPropagation(),W(n.supplier_id,n.product_id)},className:"mt-2 text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Review Product"})]})]},n.order_item_id))})]},s)})]}),r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Delivery Information"}),ce&&e.jsxs("button",{onClick:()=>$(!0),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Reschedule"]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-900",children:r.delivery_status.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())})]}),e.jsxs("p",{className:"text-sm text-blue-800",children:["Delivery Window: ",C(r.delivery_window_start)," - ",new Date(r.delivery_window_end).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]}),r.tracking_number&&e.jsxs("p",{className:"text-sm text-blue-800 mt-1",children:["Tracking: ",r.tracking_number]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Delivery Address"}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.delivery_address_id}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["(Address details loaded from address_id: ",a.delivery_address_id,")"]})]})]}),r.delivery_status==="delivered"&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-900",children:"Delivered Successfully"})]}),e.jsxs("p",{className:"text-sm text-green-800",children:["Delivered on ",r.actual_delivery_time?C(r.actual_delivery_time):"N/A"]}),r.delivery_proof_photo_url&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-green-800 mb-2",children:"Delivery Proof:"}),e.jsx("img",{src:r.delivery_proof_photo_url,alt:"Delivery proof",className:"rounded-lg border border-green-300 max-w-xs"})]}),r.delivery_notes&&e.jsxs("p",{className:"text-sm text-green-800 mt-2",children:["Note: ",r.delivery_notes]})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:j(a.subtotal_amount)})]}),e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Delivery Fee:"}),e.jsx("span",{children:j(a.delivery_fee_total)})]}),e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Tax:"}),e.jsx("span",{children:j(a.tax_amount)})]}),a.discount_amount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-",j(a.discount_amount)]})]}),e.jsx("div",{className:"pt-3 border-t-2 border-gray-300",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:j(a.total_amount)})]})})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-900",children:[e.jsx(Oe,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"capitalize",children:a.payment_method.replace("_"," ")})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Status: ",e.jsx("span",{className:"font-medium capitalize",children:a.payment_status})]}),a.promo_code_used&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Promo code applied: ",a.promo_code_used]})]}),a.customer_notes&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Order Notes"}),e.jsxs("p",{className:"text-sm text-gray-600 italic",children:['"',a.customer_notes,'"']})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"space-y-3",children:[xe&&e.jsxs(S,{to:`/report-issue?order_id=${t}`,className:"w-full inline-flex items-center justify-center px-4 py-3 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Report Issue"]}),e.jsxs("button",{onClick:()=>o("/support"),className:"w-full inline-flex items-center justify-center px-4 py-3 bg-gray-100 text-gray-900 font-medium rounded-lg hover:bg-gray-200 transition-colors border border-gray-300",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Contact Support"]}),K&&e.jsx("button",{type:"button",onClick:s=>{s.preventDefault(),s.stopPropagation();const l=B[0];l&&W(l.supplier_id,l.product_id)},className:"w-full inline-flex items-center justify-center px-4 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Leave Review"})]})]})]})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Cancel Order"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to cancel this order? This action cannot be undone."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"cancellation_reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation"}),e.jsx("textarea",{id:"cancellation_reason",value:N,onChange:s=>P(s.target.value),rows:3,placeholder:"Please tell us why you're cancelling...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]}),p.error&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:g.isAxiosError(p.error)?((V=(Y=p.error.response)==null?void 0:Y.data)==null?void 0:V.message)||"Failed to cancel order":"An error occurred"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{R(!1),P("")},disabled:p.isPending,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-900 font-medium rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Keep Order"}),e.jsx("button",{onClick:be,disabled:p.isPending||!N.trim(),className:"flex-1 px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p.isPending?"Cancelling...":"Yes, Cancel Order"})]})]})}),ae&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Reschedule Delivery"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Choose a new delivery window for your order."}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new_start",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Delivery Start"}),e.jsx("input",{type:"datetime-local",id:"new_start",value:w,onChange:s=>A(s.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new_end",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Delivery End"}),e.jsx("input",{type:"datetime-local",id:"new_end",value:_,onChange:s=>O(s.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]})]}),y.error&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:g.isAxiosError(y.error)?((X=(J=y.error.response)==null?void 0:J.data)==null?void 0:X.message)||"Failed to reschedule delivery":"An error occurred"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{$(!1),A(""),O("")},disabled:y.isPending,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-900 font-medium rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:ge,disabled:y.isPending||!w||!_,className:"flex-1 px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?"Rescheduling...":"Confirm"})]})]})}),ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full p-6 my-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Leave a Review"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overall Rating *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>u({...i,rating_overall:s}),className:"transition-colors",children:e.jsx(D,{className:`w-8 h-8 ${s<=i.rating_overall?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},s)),e.jsxs("span",{className:"ml-2 text-gray-700 font-medium",children:[i.rating_overall," / 5"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Quality"}),e.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>u({...i,rating_product:s}),className:"transition-colors",children:e.jsx(D,{className:`w-6 h-6 ${s<=i.rating_product?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Quality"}),e.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>u({...i,rating_service:s}),className:"transition-colors",children:e.jsx(D,{className:`w-6 h-6 ${s<=i.rating_service?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Experience"}),e.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>u({...i,rating_delivery:s}),className:"transition-colors",children:e.jsx(D,{className:`w-6 h-6 ${s<=i.rating_delivery?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},s))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"review_text",className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review *"}),e.jsx("textarea",{id:"review_text",value:i.review_text,onChange:s=>u({...i,review_text:s.target.value}),rows:5,placeholder:"Share your experience with this order...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Would you buy again?"}),e.jsx("div",{className:"flex gap-3",children:["yes","maybe","no"].map(s=>e.jsx("button",{type:"button",onClick:()=>u({...i,would_buy_again:s}),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${i.would_buy_again===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s==="yes"?"Yes":s==="maybe"?"Maybe":"No"},s))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_anonymous",checked:i.is_anonymous,onChange:s=>u({...i,is_anonymous:s.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"is_anonymous",className:"ml-2 text-sm text-gray-700",children:"Post anonymously"})]})]}),v.error&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:g.isAxiosError(v.error)?((Z=(H=v.error.response)==null?void 0:H.data)==null?void 0:Z.message)||"Failed to submit review":"An error occurred"})}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{F(!1),u({supplier_id:"",product_id:"",rating_overall:5,rating_product:5,rating_service:5,rating_delivery:5,review_text:"",would_buy_again:"yes",is_anonymous:!1})},disabled:v.isPending,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-900 font-medium rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:ye,disabled:v.isPending||!i.review_text.trim(),className:"flex-1 px-4 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v.isPending?"Submitting...":"Submit Review"})]})]})})]})};export{Ke as default};
