import{u as G,j as e}from"./state-vendor-__gb9IU9.js";import{e as K,r as v,L as O}from"./react-vendor-QYi6USC3.js";import{u as E,a as U}from"./index-CrNOa18y.js";import{S as $,X as g,a0 as W,h as H,a8 as J,P as N,$ as X,D as Z,a4 as ee,am as se,W as re,K as te,q as ae,J as le}from"./ui-vendor-CuJPReAW.js";const I=[{value:"pending",label:"Pending",color:"orange"},{value:"processing",label:"Processing",color:"orange"},{value:"shipped",label:"Shipped",color:"blue"},{value:"in_transit",label:"In Transit",color:"blue"},{value:"delivered",label:"Delivered",color:"green"},{value:"cancelled",label:"Cancelled",color:"red"}],M=[{value:"all_time",label:"All Time"},{value:"today",label:"Today"},{value:"last_7_days",label:"Last 7 Days"},{value:"last_30_days",label:"Last 30 Days"},{value:"last_3_months",label:"Last 3 Months"},{value:"last_6_months",label:"Last 6 Months"},{value:"last_year",label:"Last Year"}],F=[{value:"order_date_desc",label:"Newest First",sort_by:"order_date",sort_order:"desc"},{value:"order_date_asc",label:"Oldest First",sort_by:"order_date",sort_order:"asc"},{value:"total_amount_desc",label:"Highest Value",sort_by:"total_amount",sort_order:"desc"},{value:"total_amount_asc",label:"Lowest Value",sort_by:"total_amount",sort_order:"asc"}],Q=20,ne=async(p,u,a,n,l,o,h,y)=>{const t=Q,m=(h-1)*t,i={limit:t,offset:m,sort_by:l,sort_order:o};return u&&(i.status_filter=u),a!=="all_time"&&(i.date_range=a),n&&(i.supplier_id=n),(await U.get("https://123create-construction-app-with-a.launchpulse.ai/api/orders",{headers:{Authorization:`Bearer ${p}`},params:i})).data},me=()=>{var A,D;const p=E(s=>s.authentication_state.auth_token),u=E(s=>{var r;return(r=s.authentication_state.customer_profile)==null?void 0:r.customer_id}),[a,n]=K(),l=a.get("status_filter"),o=a.get("date_range")||"all_time",h=a.get("supplier_id"),y=a.get("sort_by")||"order_date_desc",t=parseInt(a.get("page")||"1",10),[m,i]=v.useState(""),[R,q]=v.useState(""),f=v.useMemo(()=>{const s=F.find(r=>r.value===y)||F[0];return{sort_by:s.sort_by,sort_order:s.sort_order}},[y]);v.useEffect(()=>{const s=setTimeout(()=>{q(m)},300);return()=>clearTimeout(s)},[m]);const{data:x,isLoading:w,isError:_,error:T,refetch:z}=G({queryKey:["orders",u,l,o,h,f.sort_by,f.sort_order,t,R],queryFn:()=>ne(p,l,o,h,f.sort_by,f.sort_order,t),enabled:!!p&&!!u,staleTime:3e4,refetchOnWindowFocus:!1}),S=(x==null?void 0:x.orders)||[],j=(x==null?void 0:x.total)||0,d=Math.ceil(j/Q),C=s=>{const r=new URLSearchParams(a);s?r.set("status_filter",s):r.delete("status_filter"),r.set("page","1"),n(r)},L=s=>{const r=new URLSearchParams(a);r.set("date_range",s),r.set("page","1"),n(r)},V=s=>{const r=new URLSearchParams(a);r.set("sort_by",s),r.set("page","1"),n(r)},P=s=>{const r=new URLSearchParams(a);r.set("page",s.toString()),n(r),window.scrollTo({top:0,behavior:"smooth"})},k=()=>{n({}),i("")},b=l||o!=="all_time"||h||m,B=s=>{switch(s){case"pending":case"processing":return"bg-orange-100 text-orange-800 border-orange-200";case"shipped":case"in_transit":return"bg-blue-100 text-blue-800 border-blue-200";case"delivered":return"bg-green-100 text-green-800 border-green-200";case"cancelled":case"refunded":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Y=s=>{switch(s){case"pending":case"processing":return e.jsx(N,{className:"w-4 h-4"});case"shipped":case"in_transit":return e.jsx(le,{className:"w-4 h-4"});case"delivered":return e.jsx(ae,{className:"w-4 h-4"});case"cancelled":return e.jsx(g,{className:"w-4 h-4"});default:return e.jsx(N,{className:"w-4 h-4"})}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Orders"}),e.jsx("p",{className:"mt-2 text-base text-gray-600",children:"Track and manage all your construction material orders"})]}),e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:m,onChange:s=>i(s.target.value),placeholder:"Search orders by number or product...",className:"block w-full pl-10 pr-3 py-3 border-2 border-gray-200 rounded-lg leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),m&&e.jsx("button",{onClick:()=>i(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(g,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("aside",{className:"hidden lg:block w-64 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden sticky top-24",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(W,{className:"w-5 h-5 mr-2"}),"Filters"]}),b&&e.jsx("button",{onClick:k,className:"text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Clear"})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Order Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>C(null),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${l?"text-gray-700 hover:bg-gray-50 border-2 border-transparent":"bg-blue-50 text-blue-700 border-2 border-blue-200"}`,children:"All Orders"}),I.map(s=>e.jsx("button",{onClick:()=>C(s.value),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${l===s.value?"bg-blue-50 text-blue-700 border-2 border-blue-200":"text-gray-700 hover:bg-gray-50 border-2 border-transparent"}`,children:s.label},s.value))]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Date Range"}),e.jsx("div",{className:"space-y-2",children:M.map(s=>e.jsx("button",{onClick:()=>L(s.value),className:`w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${o===s.value?"bg-blue-50 text-blue-700 border-2 border-blue-200":"text-gray-700 hover:bg-gray-50 border-2 border-transparent"}`,children:s.label},s.value))})]})]})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[b&&e.jsx("div",{className:"mb-6 lg:hidden",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active Filters:"}),l&&e.jsxs("button",{onClick:()=>C(null),className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ",(A=I.find(s=>s.value===l))==null?void 0:A.label,e.jsx(g,{className:"ml-2 w-3 h-3"})]}),o!=="all_time"&&e.jsxs("button",{onClick:()=>L("all_time"),className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:[(D=M.find(s=>s.value===o))==null?void 0:D.label,e.jsx(g,{className:"ml-2 w-3 h-3"})]}),e.jsx("button",{onClick:k,className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Clear All"})]})}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium text-gray-900",children:j}),e.jsxs("span",{className:"ml-1",children:[j===1?"order":"orders"," found"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{htmlFor:"sort",className:"text-sm font-medium text-gray-700",children:"Sort by:"}),e.jsx("select",{id:"sort",value:y,onChange:s=>V(s.target.value),className:"block w-48 pl-3 pr-10 py-2 text-sm border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 rounded-lg transition-all duration-200",children:F.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),w&&e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]})]})},s))}),_&&e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-8 text-center",children:[e.jsx(H,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Failed to Load Orders"}),e.jsx("p",{className:"text-red-700 mb-4",children:U.isAxiosError(T)?T.message:"An unexpected error occurred"}),e.jsxs("button",{onClick:()=>z(),className:"inline-flex items-center px-6 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Retry"]})]}),!w&&!_&&S.length===0&&e.jsxs("div",{className:"bg-white rounded-xl border-2 border-dashed border-gray-300 p-12 text-center",children:[e.jsx(N,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:b?"No Orders Found":"No Orders Yet"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:b?"No orders match your current filters. Try adjusting your search or filters.":"You haven't placed any orders yet. Start browsing construction materials to get started."}),b?e.jsxs("button",{onClick:k,className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Clear Filters"]}):e.jsxs(O,{to:"/products",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Browse Products"]})]}),!w&&!_&&S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:S.map(s=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg hover:border-blue-200 transition-all duration-200 group",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[s.primary_product_thumbnail&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:s.primary_product_thumbnail,alt:"Order product",className:"w-20 h-20 object-cover rounded-lg border-2 border-gray-100"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.order_number}),e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${B(s.status)}`,children:[Y(s.status),e.jsx("span",{className:"ml-1.5 capitalize",children:s.status.replace("_"," ")})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsxs("span",{children:["Placed on"," ",new Date(s.order_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",Number(s.total_amount).toFixed(2)]})]}),s.items_count&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsxs("span",{children:[s.items_count," ",s.items_count===1?"item":"items"]})]})]})]})]})}),e.jsxs("div",{className:"flex lg:flex-col items-center lg:items-end space-x-2 lg:space-x-0 lg:space-y-2",children:[e.jsxs(O,{to:`/orders/${s.order_id}`,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-all duration-200 hover:shadow-lg",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"View Details"]}),s.status==="delivered"&&e.jsxs(O,{to:`/orders/${s.order_id}/reorder`,className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-all duration-200 border border-gray-300",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Reorder"]})]})]})})},s.order_id))}),d>1&&e.jsx("div",{className:"mt-8 flex items-center justify-center",children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-lg shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>P(t-1),disabled:t===1,className:"relative inline-flex items-center px-4 py-2 rounded-l-lg border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(re,{className:"w-5 h-5"})}),Array.from({length:Math.min(d,7)},(s,r)=>{let c;return d<=7||t<=4?c=r+1:t>=d-3?c=d-6+r:c=t-3+r,e.jsx("button",{onClick:()=>P(c),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium transition-colors ${t===c?"z-10 bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:c},c)}),e.jsx("button",{onClick:()=>P(t+1),disabled:t===d,className:"relative inline-flex items-center px-4 py-2 rounded-r-lg border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]})}),d>1&&e.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Showing page ",t," of ",d," (",j," total orders)"]})]})]})]})})]})})};export{me as default};
