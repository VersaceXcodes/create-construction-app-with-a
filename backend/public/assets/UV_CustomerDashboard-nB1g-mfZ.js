import{u as y,j as e}from"./state-vendor-__gb9IU9.js";import{L as i}from"./react-vendor-QYi6USC3.js";import{u as f,a as N}from"./index-DxqMT8zM.js";import{T as C,S as $,a8 as T,V as q,a9 as D,K as L,h as R,P as w,I as O,$ as F,aa as B}from"./ui-vendor-CuJPReAW.js";const v="https://123create-construction-app-with-a.launchpulse.ai/api",E=async t=>((await N.get(`${v}/orders`,{headers:{Authorization:`Bearer ${t}`},params:{status_filter:"pending,processing,shipped,in_transit",limit:3,sort_by:"order_date",sort_order:"desc"}})).data.orders||[]).map(l=>{var a,o,c,j,x,m,h,u;return{order_id:l.order_id,order_number:l.order_number,order_date:l.order_date,status:l.status,total_amount:Number(l.total_amount||0),delivery_status:((a=l.delivery)==null?void 0:a.delivery_status)||"unknown",estimated_delivery:((o=l.delivery)==null?void 0:o.delivery_window_end)||null,primary_product:{product_name:((j=(c=l.items)==null?void 0:c[0])==null?void 0:j.product_name)||"N/A",product_id:((m=(x=l.items)==null?void 0:x[0])==null?void 0:m.product_id)||"",thumbnail_url:((u=(h=l.items)==null?void 0:h[0])==null?void 0:u.primary_image_url)||"/placeholder-product.png"}}}),I=async t=>(await N.get(`${v}/products`,{headers:{Authorization:`Bearer ${t}`},params:{limit:12,sort_by:"sales_count",sort_order:"desc",in_stock_only:!0}})).data.products||[],W=async t=>((await N.get(`${v}/wishlist`,{headers:{Authorization:`Bearer ${t}`}})).data||[]).length,K=async t=>((await N.get(`${v}/projects`,{headers:{Authorization:`Bearer ${t}`}})).data||[]).length,_=t=>{const r=new Date(t),l=new Date().getTime()-r.getTime(),a=Math.floor(l/(1e3*60*60*24));return a===0?"Today":a===1?"Yesterday":a<7?`${a} days ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),M=t=>({pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",in_transit:"bg-indigo-100 text-indigo-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[t]||"bg-gray-100 text-gray-800",Y=()=>{var S;const t=f(s=>s.authentication_state.current_user),r=f(s=>s.authentication_state.customer_profile),d=f(s=>s.authentication_state.auth_token),l=f(s=>s.cart_state.total_items),{data:a=[],isLoading:o,error:c,refetch:j}=y({queryKey:["active-orders",{limit:3}],queryFn:()=>E(d),enabled:!!d,staleTime:6e4,retry:1,refetchOnWindowFocus:!1}),{data:x=[],isLoading:m,error:h}=y({queryKey:["recommended-products",{limit:12}],queryFn:()=>I(d),enabled:!!d,staleTime:6e4,retry:1,refetchOnWindowFocus:!1}),{data:u=0}=y({queryKey:["wishlist-count"],queryFn:()=>W(d),enabled:!!d,staleTime:6e4,retry:1,refetchOnWindowFocus:!1}),{data:k=0}=y({queryKey:["projects-count"],queryFn:()=>K(d),enabled:!!d,staleTime:6e4,retry:1,refetchOnWindowFocus:!1}),A=a.filter(s=>["scheduled","out_for_delivery","preparing"].includes(s.delivery_status)).map(s=>({delivery_id:`del_${s.order_id}`,order_id:s.order_id,order_number:s.order_number,supplier_name:"Supplier",delivery_window_start:s.estimated_delivery||"",delivery_window_end:s.estimated_delivery||"",delivery_status:s.delivery_status})).slice(0,1),g={spending_this_month:a.reduce((s,b)=>s+b.total_amount,0),orders_this_month:a.length,trade_credit_available:(r==null?void 0:r.trade_credit_balance)||null,trade_credit_limit:(r==null?void 0:r.trade_credit_limit)||null};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[t!=null&&t.profile_photo_url?e.jsx("img",{src:t.profile_photo_url,alt:`${t.first_name} ${t.last_name}`,className:"h-16 w-16 rounded-full object-cover border-2 border-blue-200"}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-600 flex items-center justify-center text-white text-2xl font-bold",children:((S=t==null?void 0:t.first_name)==null?void 0:S.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 leading-tight",children:["Welcome back, ",(t==null?void 0:t.first_name)||"Customer","!"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),(r==null?void 0:r.account_type)==="trade"&&e.jsx("div",{className:"hidden md:block",children:e.jsxs("span",{className:"inline-flex items-center px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold text-sm shadow-lg",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Trade Account"]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(i,{to:"/products",className:"flex flex-col items-center justify-center p-6 rounded-lg border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-all duration-200 group",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center mb-3 group-hover:bg-blue-600 transition-colors",children:e.jsx($,{className:"h-6 w-6 text-blue-600 group-hover:text-white"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 text-center",children:"Search Products"})]}),e.jsxs("button",{onClick:()=>{a.length>0&&alert("Reorder functionality coming soon")},disabled:a.length===0,className:"flex flex-col items-center justify-center p-6 rounded-lg border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all duration-200 group disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:border-gray-200 disabled:hover:bg-white",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center mb-3 group-hover:bg-green-600 transition-colors",children:e.jsx(T,{className:"h-6 w-6 text-green-600 group-hover:text-white"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 text-center",children:"Reorder Last"})]}),e.jsxs(i,{to:"/wishlist",className:"flex flex-col items-center justify-center p-6 rounded-lg border-2 border-gray-200 hover:border-red-500 hover:bg-red-50 transition-all duration-200 group relative",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center mb-3 group-hover:bg-red-600 transition-colors",children:e.jsx(q,{className:"h-6 w-6 text-red-600 group-hover:text-white"})}),u>0&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-600 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center",children:u}),e.jsx("span",{className:"text-sm font-medium text-gray-900 text-center",children:"Saved Items"})]}),e.jsxs(i,{to:"/projects",className:"flex flex-col items-center justify-center p-6 rounded-lg border-2 border-gray-200 hover:border-purple-500 hover:bg-purple-50 transition-all duration-200 group relative",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-purple-100 flex items-center justify-center mb-3 group-hover:bg-purple-600 transition-colors",children:e.jsx(D,{className:"h-6 w-6 text-purple-600 group-hover:text-white"})}),k>0&&e.jsx("span",{className:"absolute top-2 right-2 bg-purple-600 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center",children:k}),e.jsx("span",{className:"text-sm font-medium text-gray-900 text-center",children:"My Projects"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Your Active Orders"}),e.jsxs(i,{to:"/orders",className:"text-blue-600 hover:text-blue-700 font-medium text-sm flex items-center transition-colors",children:["View All",e.jsx(L,{className:"h-4 w-4 ml-1"})]})]}),o&&e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"bg-gray-200 h-20 w-20 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"bg-gray-200 h-4 w-1/3 rounded"}),e.jsx("div",{className:"bg-gray-200 h-3 w-1/2 rounded"}),e.jsx("div",{className:"bg-gray-200 h-3 w-1/4 rounded"})]})]})},s))}),c&&!o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(R,{className:"h-5 w-5 text-red-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-red-800 font-medium",children:"Failed to load orders"}),e.jsxs("button",{onClick:()=>j(),className:"text-red-600 hover:text-red-700 text-sm font-medium mt-2 flex items-center",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"Try again"]})]})]})}),!o&&!c&&a.length>0&&e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx(i,{to:`/orders/${s.order_id}`,className:"block border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:s.primary_product.thumbnail_url,alt:s.primary_product.product_name,className:"h-20 w-20 rounded-lg object-cover border border-gray-200",onError:b=>{const n=b.target;n.dataset.fallbackAttempted?n.onerror=null:(n.dataset.fallbackAttempted="true",n.src="/placeholder-product.png")}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-600",children:["Order #",s.order_number]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${M(s.status)}`,children:s.status.replace("_"," ")})]}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate mb-1",children:s.primary_product.product_name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:_(s.order_date)}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:p(s.total_amount)}),s.estimated_delivery&&e.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:["Arriving ",_(s.estimated_delivery)]})]})]})]})},s.order_id))}),!o&&!c&&a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(w,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No active orders"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start shopping to place your first order"}),e.jsxs(i,{to:"/products",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-lg hover:shadow-xl",children:[e.jsx($,{className:"h-5 w-5 mr-2"}),"Browse Products"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recommended For You"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Based on your preferences"})]}),m&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"bg-gray-200 h-48 rounded-lg mb-2"}),e.jsx("div",{className:"bg-gray-200 h-4 w-3/4 rounded mb-2"}),e.jsx("div",{className:"bg-gray-200 h-3 w-1/2 rounded"})]},s))}),h&&!m&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"Unable to load recommendations"})}),!m&&!h&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:x.slice(0,8).map(s=>e.jsx(i,{to:`/product/${s.product_id}`,className:"group",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-xl hover:border-blue-500 transition-all duration-200",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("img",{src:s.primary_image_url||"/placeholder-product.png",alt:s.product_name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:b=>{const n=b.target;n.dataset.fallbackAttempted?n.onerror=null:(n.dataset.fallbackAttempted="true",n.src="/placeholder-product.png")}}),s.stock_quantity>0&&s.stock_quantity<=10&&e.jsx("span",{className:"absolute top-2 right-2 bg-amber-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:"Low Stock"})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate mb-1 group-hover:text-blue-600",children:s.product_name}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:p(Number(s.price_per_unit||0))}),s.stock_quantity>0?e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"In Stock"}):e.jsx("span",{className:"text-xs text-red-600 font-medium",children:"Out of Stock"})]})]})},s.product_id))}),x.length>8&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(i,{to:"/products",className:"inline-flex items-center text-blue-600 hover:text-blue-700 font-medium transition-colors",children:["See All Recommendations",e.jsx(O,{className:"h-4 w-4 ml-1"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Activity tracking coming soon"})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl shadow-lg p-6 text-white",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(C,{className:"h-5 w-5 mr-2"}),"Account Summary"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4 backdrop-blur-sm",children:[e.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"Spending This Month"}),e.jsx("p",{className:"text-2xl font-bold",children:p(g.spending_this_month)})]}),e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4 backdrop-blur-sm",children:[e.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"Orders This Month"}),e.jsx("p",{className:"text-2xl font-bold",children:g.orders_this_month})]}),g.trade_credit_limit&&e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4 backdrop-blur-sm",children:[e.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"Available Credit"}),e.jsx("p",{className:"text-2xl font-bold",children:p(g.trade_credit_available||0)}),e.jsxs("p",{className:"text-blue-100 text-xs mt-1",children:["of ",p(g.trade_credit_limit)," limit"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(w,{className:"h-5 w-5 mr-2 text-blue-600"}),"Upcoming Deliveries"]}),A.length>0?e.jsx("div",{className:"space-y-4",children:A.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-500 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Order #",s.order_number]}),e.jsx("span",{className:"text-xs font-semibold text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:s.delivery_status})]}),s.delivery_window_end&&e.jsxs("div",{className:"flex items-center text-gray-900 mb-2",children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium",children:_(s.delivery_window_end)})]}),e.jsxs(i,{to:`/orders/${s.order_id}`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center mt-3",children:["Track Order",e.jsx(O,{className:"h-4 w-4 ml-1"})]})]},s.delivery_id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(w,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"No scheduled deliveries"})]})]}),l>0&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-6 w-6 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Your Cart"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l," items waiting"]})]})]})}),e.jsx(i,{to:"/cart",className:"block w-full bg-green-600 text-white text-center py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors shadow-lg hover:shadow-xl",children:"View Cart & Checkout"})]})]})]})})]})})};export{Y as default};
