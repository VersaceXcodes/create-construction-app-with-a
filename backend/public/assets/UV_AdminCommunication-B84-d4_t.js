import{a as ie,u as E,b as P,j as e}from"./state-vendor-__gb9IU9.js";import{e as ce,r as c}from"./react-vendor-QYi6USC3.js";import{u as de,a as g}from"./index-BLkJOUb3.js";import{w as oe,B as O,F as Q,d as me,U as R,k as w,a0 as xe,f as _,N as he,a4 as ue,T as V,af as ge,x as pe,p as W,e as be,X as D,aE as ye}from"./ui-vendor-CuJPReAW.js";const je=async r=>{const{data:a}=await g.get("https://123create-construction-app-with-a.launchpulse.ai/api/admin/communications/announcements?include_analytics=true&status=active,scheduled,draft",{headers:{Authorization:`Bearer ${r}`}});return a},fe=async(r,a)=>{const{data:o}=await g.post("https://123create-construction-app-with-a.launchpulse.ai/api/admin/communications/announcements",{title:a.subject,content:a.content,target_segments:a.target_segments,delivery_channels:a.delivery_channels,schedule_date:a.schedule_date},{headers:{Authorization:`Bearer ${r}`}});return o},Ne=async r=>{const{data:a}=await g.get("https://123create-construction-app-with-a.launchpulse.ai/api/admin/users/segments",{headers:{Authorization:`Bearer ${r}`}});return a},ve=async r=>{const{data:a}=await g.get("https://123create-construction-app-with-a.launchpulse.ai/api/admin/notifications/templates?template_type=email,sms",{headers:{Authorization:`Bearer ${r}`}});return a},we=async(r,a,o)=>{const{data:n}=await g.put(`https://123create-construction-app-with-a.launchpulse.ai/api/admin/notifications/templates/${a}`,o,{headers:{Authorization:`Bearer ${r}`}});return n},_e=async(r,a,o)=>{const{data:n}=await g.post("https://123create-construction-app-with-a.launchpulse.ai/api/admin/communications/emergency-broadcast",{message:a,severity:o,channels:["email","sms","in_app"],target_all_users:!0},{headers:{Authorization:`Bearer ${r}`}});return n},Ae=()=>{var L,z;const[r,a]=ce(),o=ie(),n=de(s=>s.authentication_state.auth_token),[l,I]=c.useState(r.get("communication_type")||"announcements"),[X,y]=c.useState(!1),[Y,C]=c.useState(!1),[x,j]=c.useState(null),[i,m]=c.useState({subject:"",content:"",target_segments:[],delivery_channels:["in_app"],schedule_date:null,is_draft:!1}),[f,k]=c.useState(""),[S,T]=c.useState("high"),[F,B]=c.useState(""),[M,G]=c.useState([]),[N,H]=c.useState("all"),{data:A,isLoading:J}=E({queryKey:["admin-announcements",N],queryFn:()=>je(n),enabled:!!n&&l==="announcements",staleTime:6e4,refetchOnWindowFocus:!1}),{data:d,isLoading:Z}=E({queryKey:["admin-user-segments"],queryFn:()=>Ne(n),enabled:!!n,staleTime:3e5,refetchOnWindowFocus:!1}),{data:$,isLoading:ee}=E({queryKey:["admin-notification-templates"],queryFn:()=>ve(n),enabled:!!n&&l==="templates",staleTime:6e4,refetchOnWindowFocus:!1}),p=P({mutationFn:s=>fe(n,s),onSuccess:()=>{o.invalidateQueries({queryKey:["admin-announcements"]}),y(!1),m({subject:"",content:"",target_segments:[],delivery_channels:["in_app"],schedule_date:null,is_draft:!1})}}),v=P({mutationFn:({template_id:s,updates:t})=>we(n,s,t),onSuccess:()=>{o.invalidateQueries({queryKey:["admin-notification-templates"]}),j(null)}}),u=P({mutationFn:({message:s,severity:t})=>_e(n,s,t),onSuccess:()=>{k(""),T("high"),C(!1)}}),b=s=>{I(s),a({communication_type:s})},U=()=>{p.mutate(i)},se=()=>{x&&v.mutate({template_id:x.template_id,updates:{template_content:F,template_variables:M}})},te=()=>{u.mutate({message:f,severity:S})},ae=s=>{m(t=>({...t,target_segments:t.target_segments.includes(s)?t.target_segments.filter(h=>h!==s):[...t.target_segments,s]}))},re=s=>{m(t=>({...t,delivery_channels:t.delivery_channels.includes(s)?t.delivery_channels.filter(h=>h!==s):[...t.delivery_channels,s]}))},q=(A==null?void 0:A.filter(s=>N==="all"?!0:s.status===N))||[],ne=i.target_segments.reduce((s,t)=>{var K;const h=(K=d==null?void 0:d.segments)==null?void 0:K.find(le=>le.segment_id===t);return s+((h==null?void 0:h.user_count)||0)},0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Platform Communication"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage announcements, templates, campaigns, and emergency broadcasts"})]}),l==="announcements"&&e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[e.jsx(oe,{className:"w-5 h-5 mr-2"}),"New Announcement"]})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>b("announcements"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${l==="announcements"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"Announcements"})]})}),e.jsx("button",{onClick:()=>b("templates"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${l==="templates"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:"Templates"})]})}),e.jsx("button",{onClick:()=>b("campaigns"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${l==="campaigns"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(me,{className:"w-5 h-5"}),e.jsx("span",{children:"Campaigns"})]})}),e.jsx("button",{onClick:()=>b("segments"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${l==="segments"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"User Segments"})]})}),e.jsx("button",{onClick:()=>b("emergency"),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${l==="emergency"?"border-red-600 text-red-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{children:"Emergency"})]})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l==="announcements"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(xe,{className:"w-5 h-5 text-gray-400"}),e.jsx("div",{className:"flex space-x-2",children:["all","active","scheduled","draft"].map(s=>e.jsx("button",{onClick:()=>H(s),className:`px-4 py-2 rounded-lg font-medium text-sm transition-colors ${N===s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]})})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Target"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Channels"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-12 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):q.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center",children:[e.jsx(O,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No announcements found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Create your first announcement to get started"})]})}):q.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-md",children:s.content})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.status==="active"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Active"]}),s.status==="scheduled"&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Scheduled"]}),s.status==="draft"&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Draft"})]}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[s.target_segments.length," segment",s.target_segments.length!==1?"s":""]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex space-x-1",children:s.delivery_channels.map(t=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700",children:t},t))})}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400 mr-1"}),e.jsx("span",{className:"text-gray-900",children:s.views_count||0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"w-4 h-4 text-gray-400 mr-1"}),e.jsxs("span",{className:"text-gray-900",children:[s.delivery_rate||0,"%"]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-red-600 hover:text-red-900",children:e.jsx(pe,{className:"w-4 h-4"})})]})})]},s.announcement_id))})]})})})]}),l==="templates"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Templates"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:ee?e.jsx("div",{className:"p-6 flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):$==null?void 0:$.map(s=>e.jsxs("button",{onClick:()=>{j(s),B(s.template_content),G(s.template_variables)},className:`w-full text-left p-4 hover:bg-gray-50 transition-colors ${(x==null?void 0:x.template_id)===s.template_id?"bg-blue-50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.template_name}),s.template_type==="email"?e.jsx(W,{className:"w-4 h-4 text-gray-400"}):e.jsx(be,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Used ",s.usage_count," times"]})]},s.template_id))})]}),e.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:x?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Edit Template"}),e.jsx("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template Name"}),e.jsx("input",{type:"text",value:x.template_name,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx("textarea",{value:F,onChange:s=>B(s.target.value),rows:10,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all",placeholder:"Enter template content..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variables"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:M.map((s,t)=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-md bg-blue-100 text-blue-800 text-sm font-medium",children:`{{${s}}}`},t))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>j(null),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:se,disabled:v.isPending,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:v.isPending?"Saving...":"Save Template"})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Select a template to edit"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Choose a template from the list to view and edit its content"})]})})]}),l==="campaigns"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Campaign Performance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Delivery Rate"}),e.jsx(V,{className:"w-5 h-5 text-blue-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"98.5%"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"+2.3% from last month"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100 rounded-lg p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Open Rate"}),e.jsx(W,{className:"w-5 h-5 text-green-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"42.8%"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"+5.1% from last month"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-100 rounded-lg p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Click Rate"}),e.jsx(ye,{className:"w-5 h-5 text-purple-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"12.4%"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"+1.8% from last month"})]})]})]})}),l==="segments"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"User Segments"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Available audience segments for targeted communications"})]}),e.jsx("div",{className:"p-6",children:Z?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(L=d==null?void 0:d.segments)==null?void 0:L.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx(R,{className:"w-5 h-5 text-blue-600"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:s.user_count.toLocaleString()}),e.jsx("span",{className:"text-xs text-gray-500",children:"users"})]})]},s.segment_id))})})]}),l==="emergency"&&e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-100 rounded-xl border-2 border-red-300 p-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-red-600 rounded-full",children:e.jsx(w,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Emergency Broadcast"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:"Send critical platform-wide notifications to all users"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Severity Level"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["low","medium","high","critical"].map(s=>e.jsx("button",{onClick:()=>T(s),className:`px-4 py-2 rounded-lg font-medium text-sm transition-all ${S===s?s==="critical"?"bg-red-600 text-white shadow-lg":s==="high"?"bg-orange-600 text-white shadow-lg":s==="medium"?"bg-yellow-600 text-white shadow-lg":"bg-blue-600 text-white shadow-lg":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Emergency Message"}),e.jsx("textarea",{value:f,onChange:s=>k(s.target.value),rows:6,placeholder:"Enter emergency message to broadcast to all users...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-red-500 focus:ring-4 focus:ring-red-100 transition-all"})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-300 p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(w,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Warning"}),e.jsx("p",{className:"text-sm text-gray-700",children:"This will send an immediate notification via email, SMS, and in-app to all platform users. This action cannot be undone. Please ensure the message is accurate before sending."})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{k(""),T("high")},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Clear"}),e.jsx("button",{onClick:()=>C(!0),disabled:!f.trim()||u.isPending,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-lg",children:u.isPending?"Sending...":"Send Emergency Broadcast"})]})]})]})})]})]}),X&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create Announcement"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Announcement Title"}),e.jsx("input",{type:"text",value:i.subject,onChange:s=>m(t=>({...t,subject:s.target.value})),placeholder:"Enter announcement title...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Content"}),e.jsx("textarea",{value:i.content,onChange:s=>m(t=>({...t,content:s.target.value})),rows:6,placeholder:"Enter announcement message...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Target Audience"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(z=d==null?void 0:d.segments)==null?void 0:z.map(s=>e.jsxs("label",{className:"flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:i.target_segments.includes(s.segment_id),onChange:()=>ae(s.segment_id),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.user_count.toLocaleString()," users"]})]})]},s.segment_id))}),e.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800 font-medium",children:["Total target audience: ",ne.toLocaleString()," users"]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Delivery Channels"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:["in_app","email","sms"].map(s=>e.jsxs("label",{className:"flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:i.delivery_channels.includes(s),onChange:()=>re(s),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:s==="in_app"?"In-App":s.toUpperCase()})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Date (Optional)"}),e.jsx("input",{type:"datetime-local",value:i.schedule_date||"",onChange:s=>m(t=>({...t,schedule_date:s.target.value||null})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to send immediately"})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>y(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{m(s=>({...s,is_draft:!0})),U()},disabled:p.isPending,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",children:"Save as Draft"}),e.jsx("button",{onClick:()=>{m(s=>({...s,is_draft:!1})),U()},disabled:!i.subject.trim()||!i.content.trim()||i.target_segments.length===0||p.isPending,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-lg",children:p.isPending?"Publishing...":"Publish Announcement"})]})]})}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:e.jsx(w,{className:"w-6 h-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Confirm Emergency Broadcast"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium mb-2",children:"You are about to send:"}),e.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',f,'"']}),e.jsxs("p",{className:"text-xs text-red-700 mt-3",children:["Severity: ",e.jsx("span",{className:"font-bold uppercase",children:S})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-6",children:"This will immediately notify all users via email, SMS, and in-app notifications. This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>C(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:te,disabled:u.isPending,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 font-medium shadow-lg",children:u.isPending?"Sending...":"Confirm & Send Now"})]})]})})}),p.isSuccess&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-xl flex items-center space-x-2 animate-fade-in",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Announcement created successfully!"})]}),v.isSuccess&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-xl flex items-center space-x-2 animate-fade-in",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Template updated successfully!"})]}),u.isSuccess&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-red-600 text-white px-6 py-3 rounded-lg shadow-xl flex items-center space-x-2 animate-fade-in",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Emergency broadcast sent!"})]})]})};export{Ae as default};
