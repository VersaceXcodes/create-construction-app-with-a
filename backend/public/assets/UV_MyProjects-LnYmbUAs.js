import{a as J,u as X,b,j as e}from"./state-vendor-__gb9IU9.js";import{u as Z,r as m,R as L,L as ee}from"./react-vendor-QYi6USC3.js";import{u as P,a as f}from"./index-CrNOa18y.js";import{w as T,a9 as $,D as z,$ as se,P as te,c as ae,af as re,ag as le,x as A}from"./ui-vendor-CuJPReAW.js";const y="https://123create-construction-app-with-a.launchpulse.ai",ne=async a=>(await f.get(`${y}/api/projects`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).data,ie=async(a,r)=>(await f.post(`${y}/api/projects/${a}/load-to-cart`,{},{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}})).data,oe=async(a,r)=>{await f.delete(`${y}/api/projects/${a}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}})},B=async(a,r)=>(await f.post(`${y}/api/projects`,a,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}})).data,q=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a),k=a=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(a)),ce=a=>({total_projects:a.length,total_estimated_value:a.reduce((r,l)=>r+(l.total_value||0),0),most_recent_project_date:a.length>0?a.sort((r,l)=>new Date(l.created_date).getTime()-new Date(r.created_date).getTime())[0].created_date:null}),ge=()=>{const a=Z(),r=J(),l=P(s=>s.authentication_state.auth_token),E=P(s=>{var t;return(t=s.authentication_state.customer_profile)==null?void 0:t.customer_id}),I=P(s=>s.fetch_cart),[S,N]=m.useState(null),[Q,x]=m.useState(!1),[W,w]=m.useState(!1),[g,v]=m.useState(""),[D,C]=m.useState(""),[o,n]=m.useState(null),{data:c=[],isLoading:h,error:p,refetch:K}=X({queryKey:["projects",E],queryFn:()=>ne(l),enabled:!!l,staleTime:6e4,retry:1}),j=L.useMemo(()=>ce(c),[c]),_=b({mutationFn:s=>ie(s,l),onSuccess:s=>{var t;r.invalidateQueries({queryKey:["cart"]}),r.invalidateQueries({queryKey:["cart-summary"]}),I(),((t=s.unavailable_items)==null?void 0:t.length)>0?n({type:"success",message:`${s.added_items} items added to cart. ${s.unavailable_items.length} items unavailable.`}):n({type:"success",message:`${s.added_items} items added to cart`}),setTimeout(()=>{a("/cart")},1500)},onError:s=>{var t,i;n({type:"error",message:((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to load project to cart"})}}),u=b({mutationFn:s=>oe(s,l),onSuccess:()=>{r.invalidateQueries({queryKey:["projects"]}),x(!1),N(null),n({type:"success",message:"Project deleted successfully"})},onError:s=>{var t,i;n({type:"error",message:((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to delete project"}),x(!1)}}),M=b({mutationFn:({project_name:s,description:t})=>B({project_name:s,description:t},l),onSuccess:()=>{r.invalidateQueries({queryKey:["projects"]}),n({type:"success",message:"Project duplicated successfully"})},onError:s=>{var t,i;n({type:"error",message:((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to duplicate project"})}}),d=b({mutationFn:({project_name:s,description:t})=>B({project_name:s,description:t},l),onSuccess:s=>{r.invalidateQueries({queryKey:["projects"]}),w(!1),v(""),C(""),n({type:"success",message:"Project created successfully"}),a(`/projects/${s.project_id}`)},onError:s=>{var t,i;n({type:"error",message:((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to create project"})}}),U=s=>{_.mutate(s)},V=s=>{N(s),x(!0)},R=()=>{S&&u.mutate(S)},H=()=>{x(!1),N(null)},O=s=>{M.mutate({project_name:`${s.project_name} (Copy)`,description:s.description})},F=()=>{w(!0)},Y=s=>{if(s.preventDefault(),!g.trim()){n({type:"error",message:"Project name is required"});return}d.mutate({project_name:g.trim(),description:D.trim()||null})},G=()=>{w(!1),v(""),C("")};return L.useEffect(()=>{if(o){const s=setTimeout(()=>{n(null)},5e3);return()=>clearTimeout(s)}},[o]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 leading-tight",children:"My Projects"}),e.jsx("p",{className:"mt-2 text-base text-gray-600 leading-relaxed",children:"Save your cart as a project template for quick reordering"})]}),e.jsxs("button",{onClick:F,className:"inline-flex items-center justify-center px-6 py-3 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-100",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),"Create New Project"]})]}),c.length>0&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-100 shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Projects"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:j.total_projects})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx($,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-100 shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Estimated Value"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:q(j.total_estimated_value)})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(z,{className:"w-6 h-6 text-green-600"})})]})}),j.most_recent_project_date&&e.jsx("div",{className:"bg-white rounded-lg border border-gray-100 shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Last Created"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-gray-900",children:k(j.most_recent_project_date)})]}),e.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:e.jsx(se,{className:"w-6 h-6 text-indigo-600"})})]})})]})]}),h&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-lg p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-4"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 bg-gray-200 rounded flex-1"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-10"})]})]},s))}),p&&!h&&e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-8 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Failed to Load Projects"}),e.jsx("p",{className:"text-gray-600 mb-6",children:p.message||"An error occurred while loading your projects"}),e.jsx("button",{onClick:()=>K(),className:"inline-flex items-center px-6 py-3 rounded-lg font-medium text-white bg-red-600 hover:bg-red-700 shadow-lg hover:shadow-xl transition-all duration-200",children:"Try Again"})]}),!h&&!p&&c.length===0&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-lg p-12 text-center",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-blue-100 rounded-full mb-4",children:e.jsx($,{className:"w-12 h-12 text-blue-600"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No Projects Yet"}),e.jsx("p",{className:"text-base text-gray-600 mb-8 max-w-md mx-auto leading-relaxed",children:"Save your cart as a project template for quick reordering. Perfect for recurring purchases and different project sizes."}),e.jsxs("button",{onClick:F,className:"inline-flex items-center px-8 py-4 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-100",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),"Create Your First Project"]})]}),!h&&!p&&c.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-lg hover:shadow-xl transition-all duration-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-gray-100",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2 line-clamp-2",children:s.project_name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(te,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Items"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:s.item_count})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(z,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Value"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:q(s.total_value||0)})]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:["Created ",k(s.created_date)]}),e.jsxs("span",{children:["Updated ",k(s.last_updated_date)]})]})})]}),e.jsxs("div",{className:"p-6 pt-4 space-y-3",children:[e.jsx("button",{onClick:()=>U(s.project_id),disabled:_.isPending,className:"w-full inline-flex items-center justify-center px-6 py-3 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-blue-100",children:_.isPending?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-5 h-5 mr-2"}),"Load to Cart"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ee,{to:`/projects/${s.project_id}`,className:"flex-1 inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium text-gray-900 bg-gray-100 hover:bg-gray-200 border border-gray-300 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-gray-100",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs("button",{onClick:()=>O(s),disabled:M.isPending,className:"flex-1 inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium text-gray-900 bg-gray-100 hover:bg-gray-200 border border-gray-300 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-gray-100",title:"Duplicate Project",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Copy"]}),e.jsx("button",{onClick:()=>V(s.project_id),disabled:u.isPending,className:"inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium text-white bg-red-600 hover:bg-red-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-red-100",title:"Delete Project",children:e.jsx(A,{className:"w-4 h-4"})})]})]})]},s.project_id))}),Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx(A,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 text-center mb-2",children:"Delete Project?"}),e.jsx("p",{className:"text-base text-gray-600 text-center leading-relaxed",children:"Are you sure you want to delete this project? This action cannot be undone."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:H,disabled:u.isPending,className:"flex-1 px-6 py-3 rounded-lg font-medium text-gray-900 bg-gray-100 hover:bg-gray-200 border border-gray-300 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-gray-100",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:u.isPending,className:"flex-1 px-6 py-3 rounded-lg font-medium text-white bg-red-600 hover:bg-red-700 shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-red-100",children:u.isPending?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Create New Project"}),e.jsx("p",{className:"text-base text-gray-600 leading-relaxed",children:"Create an empty project that you can add products to later."})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"new_project_name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{id:"new_project_name",type:"text",value:g,onChange:s=>v(s.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all",placeholder:"e.g., Office Renovation 2024",autoFocus:!0,disabled:d.isPending})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new_project_description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{id:"new_project_description",value:D,onChange:s=>C(s.target.value),rows:3,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all",placeholder:"Add a description for this project",disabled:d.isPending})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:G,disabled:d.isPending,className:"flex-1 px-6 py-3 rounded-lg font-medium text-gray-900 bg-gray-100 hover:bg-gray-200 border border-gray-300 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d.isPending||!g.trim(),className:"flex-1 px-6 py-3 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-blue-100",children:d.isPending?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Project"})]})]})]})}),o&&e.jsx("div",{className:"fixed bottom-8 right-8 z-50 animate-in slide-in-from-bottom-4 duration-300",children:e.jsxs("div",{className:`rounded-xl shadow-2xl px-6 py-4 flex items-center space-x-3 max-w-md ${o.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:[o.type==="success"?e.jsx("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-6 h-6 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:"font-medium",children:o.message}),e.jsx("button",{onClick:()=>n(null),className:"ml-auto flex-shrink-0 hover:bg-white/20 rounded-lg p-1 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})})})};export{ge as default};
